#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include <stdarg.h>
#include <stddef.h>
#include <setjmp.h>
#include <cmocka.h>

#include <vfs.h>

#include "vfs_local_fs.h"



extern void test_vfs_local_fs_open() {

  vfs_config* conf = malloc(sizeof(vfs_config));
  
  assert_non_null(conf);
  if (!conf) return;


  snprintf(conf->connection_string, sizeof(conf->connection_string), "%s", "local:///dev/shm");
  // snprintf(conf->connection_string, sizeof(conf->connection_string), "%s", "ftp://127.0.0.1@utest@ptest");
  // snprintf(conf->connection_string, sizeof(conf->connection_string), "%s", "AAA");

  vfs_h* vfs = vfs_new(conf);
  
  assert_non_null(vfs);
  assert_non_null(vfs->open);
  assert_non_null(vfs->close);
  
  if (!vfs || !vfs->open || !vfs->close) return;

  int ret = vfs->open();
  vfs_close(vfs);

  assert_true(ret > 0);

}

extern void test_vfs_local_fs_get_all_files() {

  vfs_h* vfs = get_vfs();

  
}
